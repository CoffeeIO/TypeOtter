var mlTex=function(e,t){function n(e){e.find("*[title!=''][title]").each(function(e){"P"===t(this).prop("tagName")?t(this).prepend('<span class="para-title">'+t(this).attr("title")+"</span>"):"SECTION"===t(this).prop("tagName")&&t(this).prepend('<a href="#mltex-toc"><h1 class="section-title">'+t(this).attr("title")+"</h1></a>"),t(this).attr("data-title",t(this).attr("title")),t(this).removeAttr("title")})}function r(e){e.find("*[name!=''][name]").each(function(e){"IMG"===t(this).prop("tagName")?t(this).before('<a name="'+t(this).attr("name")+'"></a>'):t(this).prepend('<a name="'+t(this).attr("name")+'"></a>')})}function a(e){var n=1;e.find("img").each(function(e){var r=t(this);"FIGURE"!==r.parent().prop("tagName")&&r.wrap("<figure>"),r.closest("figure").attr("data-fig",n++)})}function i(e){e.find("img[caption!=''][caption]").each(function(e){var n=t(this),r=n.closest("figure").attr("data-fig");n.after("<figcaption>Figure "+r+": "+n.attr("caption")+"</figcaption>")})}function o(e){e.find("img[width!=''][width]").each(function(e){t(this).css("width",t(this).attr("width"))}),e.find("img[height!=''][height]").each(function(e){t(this).css("height",t(this).attr("height"))})}function l(e){e.find('a[url=""]').each(function(e){var n=t(this),r=n.attr("href");n.html(r).attr("target","_blank")})}function c(e){e.find('*[newpage=""]').each(function(){var e=t(this);e.before('<div class="tex-newpage"></div>')})}function s(e){e.find("script").remove()}return e.attrify=function(e){l(e),c(e),a(e),n(e),r(e),i(e),o(e),s(e)},e}(mlTex||{},jQuery),mlTex=function(e,t){function n(e,n){var r=[];return e.find('a[cite=""]').each(function(){var e=t(this),a=e.attr("href"),i="";if(void 0===a)return console.error('Cite needs "href" attribute: %s',e.clone().wrap("<span>").parent().html()),!0;if(a=a.substr(1),null===n)return console.error("Could not find reference: %s",a),!0;var o=n[a];if(void 0===o)return console.error("Could not find reference: %s",a),!0;if(void 0===o.title||""===o.title.trim())return console.error('Reference "%s" needs a title',a),!0;if(void 0===o["tex-ref-name"]){var l=o.title.substr(0,3),c="";void 0===r[l]?r[l]=1:r[l]++,r[l]<10&&(c="0");var s=l+c+r[l];o["tex-ref-name"]=s}void 0===o["tex-ref-count"]&&(o["tex-ref-count"]=0),o["tex-ref-count"]++,void 0!==e.attr("cmt")&&""!==e.attr("cmt").trim()&&(i=", "+e.attr("cmt")),e.html(o["tex-ref-name"]+i)}),n}function r(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function a(e){var t='<span class="tex-ref-book">';return o.forEach(function(n){void 0!==e[n]&&(t+='<span class="tex-book-'+n+'">'+e[n]+"</span>")}),void 0!==e["tex-ref-count"]&&(t+='<span class="tex-book-cite" tex-count="'+e["tex-ref-count"]+'"></span>'),t+"</span>"}function i(e,t){var n=r(t);n.forEach(function(t){t.startsWith("tex-")||o.indexOf(t)===-1&&console.warn('Unknown attribute in "%s": %s',e,t)})}var o=["author","title","editor","edition","volume","series","number","note","address","publisher","month","year"];return e.makeRefPage=function(e,t){var t=n(e,t),o=!1,l=r(t),c='<div class="tex-ref"><h1 class="tex-ref-title">References</h1><table>';l.forEach(function(e){i(e,t[e]),void 0!==t[e]["tex-ref-name"]&&(o=!0,c+='<tr class="tex-ref-row" tex-ref-name="'+e+'">',c+='<a name="'+e+'"></a>',c+='<td><span class="tex-ref-name">'+t[e]["tex-ref-name"]+"</span></td>",c+="<td>"+a(t[e])+"</td>",c+="</tr>")}),c+="</table></div>",o&&e.append(c)},e.fillRef=function(e){e.find(".tex-ref-row").each(function(){var n=t(this),a=n.attr("tex-ref-name"),i=[];e.find('a[cite=""][href="#'+a+'"]').each(function(){var e=t(this),n=e.closest(".page").attr("data-page");i[n]=!0});var o=r(i),l=n.find(".tex-book-cite"),c="";o.forEach(function(e){c+='<a href="#tex-page-'+e+'">'+e+"</a>, "}),c=c.substr(0,c.length-2),l.html(c),l.attr("tex-count",o.length)})},e}(mlTex||{},jQuery),mlTex=function(e,t){return e.includeFiles=function(e){var n=0;e.find('a[include=""]').each(function(e){var r=t(this),a=r.attr("href");void 0!==a&&""!==a&&(n++,r.load(a,function(e){void 0===e?console.error('File: "%s" was not found',a):r.after(r.html()),r.remove(),n--}))});var r=setInterval(function(){n<=0&&(e.find('a[include=""]').length>0&&this.includeFiles(e),clearInterval(r))},50)},e}(mlTex||{},jQuery),mlTex=function(e,t){return e.inlineMath="a579438542e77567a744e7abaeaac7ae",e.blockMath="1a73f16f7ac6dc3674c729ed2524bcc6",e.handleMath=function(n){var r=1;n.find("e").each(function(){var n=t(this);0===n.closest("p").length?(n.html(e.blockMath+n.html()+e.blockMath),n.attr("data-math",r++).attr("tex-math-style","block")):(n.html(e.inlineMath+n.html()+e.inlineMath),n.attr("tex-math-style","inline"))})},e.fillMath=function(e){e.find('e[tex-math-style="block"]').each(function(){var e=t(this),n=e.find(".MathJax_Display");n.append('<span class="tex-math-count" style="line-height: '+n.outerHeight()+'px">'+e.attr("data-math")+"</span>")})},e}(mlTex||{},jQuery);window.MathJax={extensions:["tex2jax.js"],jax:["input/TeX","output/HTML-CSS"],tex2jax:{inlineMath:[["a579438542e77567a744e7abaeaac7ae","a579438542e77567a744e7abaeaac7ae"]],displayMath:[["1a73f16f7ac6dc3674c729ed2524bcc6","1a73f16f7ac6dc3674c729ed2524bcc6"]],processEscapes:!0},skipStartupTypeset:!0,showProcessingMessages:!1,messageStyle:"none","HTML-CSS":{availableFonts:["TeX"]}};var mlTex=function(e,t){function n(e,t){for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function r(e){var t=/^[\s]*([0-9]+[\w%]*)[\s]+([0-9]+[\w%]*)[\s]+([0-9]+[\w%]*)[\s]+([0-9]+[\w%]*)[\s]*$/,n=/^[\s]*([0-9]+[\w%]*)[\s]+([0-9]+[\w%]*)[\s]*$/,r=/^[\s]*([0-9]+[\w%]*)[\s]*$/,a=t.exec(e);return null!==a?{top:a[1],right:a[2],bottom:a[3],left:a[4]}:(a=n.exec(e),null!==a?{top:a[1],right:a[2],bottom:a[1],left:a[2]}:(a=r.exec(e),null!==a?{top:a[1],right:a[1],bottom:a[1],left:a[1]}:null))}function a(e){var n=r(e.padding),a="body {  width: "+e.width+"; }.page { height: calc("+e.height+" - "+n.top+" - "+n.bottom+"); width: calc("+e.width+" - "+n.left+" - "+n.right+"); padding: "+e.padding+"; }.content { height: calc("+e.height+" - "+n.top+" - "+n.bottom+" - "+e.headerHeight+" - "+e.footerHeight+"); }.header { height: "+e.headerHeight+"; line-height: "+e.headerHeight+"; }.footer { height: "+e.footerHeight+"; line-height: "+e.footerHeight+"; }";t('<style type="text/css">'+a+"</style>").appendTo("head")}function i(e,t){return e.pager.replace("[cur]",t.number).replace("[total]",t.total)}function o(e,t){var n=t.header.wrapper,r="";return"[pager]"!==e.headerLeft&&"[pager]"!==e.headerCenter&&"[pager]"!==e.headerRight||(r=i(e,t)),""!==e.headerLeft&&(n+="[pager]"===e.headerLeft?'<div class="left">'+r+"</div>":'<div class="left">'+e.headerLeft+"</div>"),""!==e.headerCenter&&(n+="[pager]"===e.headerCenter?'<div class="center">'+r+"</div>":'<div class="center">'+e.headerCenter+"</div>"),""!==e.headerRight&&(n+="[pager]"===e.headerRight?'<div class="right">'+r+"</div>":'<div class="right">'+e.headerRight+"</div>"),n+="</div>"}function l(e,t){var n=t.footer.wrapper,r="";return"[pager]"!==e.footerLeft&&"[pager]"!==e.footerCenter&&"[pager]"!==e.footerRight||(r=i(e,t)),""!==e.footerLeft&&(n+="[pager]"===e.footerLeft?'<div class="left">'+r+"</div>":'<div class="left">'+e.footerLeft+"</div>"),""!==e.footerCenter&&(n+="[pager]"===e.footerCenter?'<div class="center">'+r+"</div>":'<div class="center">'+e.footerCenter+"</div>"),""!==e.footerRight&&(n+="[pager]"===e.footerRight?'<div class="right">'+r+"</div>":'<div class="right">'+e.footerRight+"</div>"),n+="</div>"}function c(e,t,n){var r='<a name="tex-page-'+n.number+'"></a>';return r+='<div class="page" data-page="'+n.number+'">',r+=e,r+='<div class="content">'+n.content+"</div>",r+=t,r+="</div>"}function s(e,t,n,r){var a=r.html();return r.append(e.clone().wrap("<div>").parent().html()),t.outerHeight(!0)<=n?{content:t,remain:null,done:!1}:(r.html(a),null)}function h(e,t,n,r){var a=s(e,t,n,r);if(null!==a)return e.remove(),a;if(e.hasClass("tex-newpage"))return e.remove(),null;if(0===e.children().length)return null;var i=["P","SCRIPT","TABLE","STYLE","FIGURE"];if(i.indexOf(e.prop("tagName"))!==-1)return null;var o=e.clone().empty(),l=o.wrap("<div>").parent().html();for(r.append(l),r=r.children(":last-child");e.children().length>0;){var c=e.children(":nth-child(1)");if(a=h(c,t,n,r),null===a)break;if(a.done===!0)break;c.remove()}return 0===r.children().length&&r.remove(),{content:t,remain:e,done:!0}}function d(e,t,n){var r=e.page.height,a=h(t,n,r,n);return e.content=a.content.html(),{page:e,remain:a.remain}}var f={height:"296mm",width:"210mm",padding:"10mm",headerHeight:"6mm",footerHeight:"6mm",headerRight:"",headerCenter:"",headerLeft:"",footerRight:"",footerCenter:"[pager]",footerLeft:"",pager:"[cur]",pagerStyle:"1"},u=function(){this.number=1,this.total=1,this.content="",this.page={wrapper:'<div class="page">',height:""},this.header={wrapper:'<div class="header">',right:"",center:"",left:""},this.footer={wrapper:'<div class="footer">',right:"",center:"",left:""}};return e.texify=function(e,r){var i=n(f,e),s=new u;r.wrapInner("<div>"),a(i);var h=[],m="",p=r.find("> div").first().clone(),v=null,g=1;r.append('<div class="page" style="height: auto"><div class="content tex-testdom"></div></div>');var x=r.find(".tex-testdom");for(s.page.height=x.height(),x.css("height","auto");""!==p.html().trim();)x.html(""),h.push(d(t.extend(!0,[],s),p,x)),v=h[h.length-1],s.number=++g,null!=v.remain?p.html(v.remain.html()):p.html("");h.forEach(function(e,t){e.page.total=h.length;var n=o(i,e.page),r=l(i,e.page),a=c(n,r,e.page);m+=a}),x.parent().remove(),r.html(m)},e}(mlTex||{},jQuery),mlTex=function(e,t){return e.makeRef=function(e){e.find('a[ref=""]').each(function(){var n=t(this),r=n.attr("href");if(void 0===r)return console.error('Reference needs "href" attribute: %s',n.clone().wrap("<span>").parent().html()),!0;var a=e.find('a[name="'+r.substr(1)+'"]').first();0!==a.closest("e").length?n.html(a.closest("e").attr("data-math")):0!==a.closest("figure").length?n.html(a.closest("figure").attr("data-fig")):0!==a.closest("section").length?n.html(a.closest("section").attr("data-ref")):console.error("Unknown reference: %s",n.attr("href"))})},e}(mlTex||{},jQuery),mlTex=function(e,t){return e.addSpinner=function(e){var t='<div class="overlay tex-spinner"></div><div class="bookshelf_wrapper tex-spinner" style="display:block;"><ul class="books_list"><li class="book_item first"></li><li class="book_item second"></li><li class="book_item third"></li><li class="book_item fourth"></li><li class="book_item fifth"></li><li class="book_item sixth"></li></ul><div class="shelf"></div></div>';e.after(t)},e.removeSpinner=function(){t(".tex-spinner.bookshelf_wrapper").animate({opacity:0},500,function(){t(".tex-spinner").remove()})},e}(mlTex||{},jQuery),mlTex=function(e,t){function n(e,t,n,r){return'<a href="#mltex-'+e+'"><div class="'+r+'" data-ref="'+e+'"><div class="left"><span>'+t+"</span>"+n+'</div><div class="right" data-pageref=""></div></div></a>'}function r(e){var r="";return e.find("section").each(function(){var e=t(this),a=e.attr("data-ref"),i=a.split(".");return void 0===i[1]||"0"===i[1]?(r+=n(a,i[0],e.attr("data-title"),"sec"),!0):void 0===i[2]||"0"===i[2]?(r+=n(a,i[0]+"."+i[1],e.attr("data-title"),"subsec"),!0):void 0===i[3]||"0"===i[3]?(r+=n(a,i[0]+"."+i[1]+"."+i[2],e.attr("data-title"),"subsubsec"),!0):void 0===i[4]||"0"===i[4]?(r+=n(a,i[0]+"."+i[1]+"."+i[2]+"."+i[3],e.attr("data-title"),"subsubsubsec"),!0):void console.error("Only 3 subsection levels supported")}),r}function a(e,t){var n='<div class="toc"><a name="mltex-toc"></a><h1 class="toc-title">'+t+"</h1>";return n+=e+"</div>"}return e.indexToc=function(e){var n=[],r=t("section");r.each(function(){var r=t(this),a=r.parentsUntil(e,"section"),o=a.length;for(void 0===n[o]&&(n[o]=0),n[o]++,i=o+1;i<n.length;i++)n[i]=0;var l=n.join("."),c=l.indexOf(".0");c!==-1&&(l=l.substr(0,c)),r.attr("data-ref",l),r.prepend('<a name="mltex-'+l+'"></a>'),r.find(".section-title").first().prepend("<span>"+l+"</span>")})},e.makeToc=function(e){var n=r(e);e.find("toc").each(function(){var e=t(this),r="";r=void 0===e.attr("data-title")?"Contents":e.attr("data-title");var i=a(n,r);e.after(i),e.remove()})},e.fillToc=function(e){e.find(".toc").each(function(){var n=t(this);n.find("> a > div").each(function(){var n=e.find('section[data-ref="'+t(this).attr("data-ref")+'"]').first(),r=n.closest(".page");t(this).find(".right").html(r.attr("data-page"))})})},e}(mlTex||{},jQuery),mlTex=function(e,t){var n=/^[\s\b]*<[\w]+/;return e.wrapper=function(e){if(void 0===e.html())return e;var t="",r=e.clone(),a=["P","SCRIPT","TH","TD","LI","STYLE","FIGCAPTION","H1","H2","H3","H4","H5","E"];if(a.indexOf(r.prop("tagName"))!==-1)return e;if(""===r.html().trim())return e;for(;r.children().length>0;){n.test(r.html())===!1&&(r.html("<p>"+r.html()),t+=r.children(":nth-child(1)").clone().wrap("<div>").parent().html(),r.children(":nth-child(1)").remove());var i=this.wrapper(r.children(":nth-child(1)"));void 0!==i.html()&&(t+=i.wrap("<div>").parent().html()),r.children(":nth-child(1)").remove()}return""!==r.html().trim()&&n.test(r.html())===!1&&(r.html("<p>"+r.html()),t+=r.children(":nth-child(1)").clone().wrap("<div>").parent().html(),r.children(":nth-child(1)").remove()),e.html(t),e},e}(mlTex||{},jQuery),mlTex=function(e,t){function n(e){if(null==e||!(e instanceof Object))return{selector:"body",options:{},biblography:{}};"string"==typeof e.selector&&""!=e.selector.trim()||(e.selector="body");var n=t(e.selector).length;return 1!==n?(0===n?console.error('Selector "%s" not found',e.selector):n>1&&console.error('Selector "%s" found mutiple elements, selector needs to be unique',e.selector),null):(null!=e.options&&e.options instanceof Object||(e.options={}),null!=e.biblography&&e.biblography instanceof Object||(e.biblography={}),e)}e.mathDone=!1,e.DEBUG=!0;var r=!1;return e.run=function(a){t(document).ready(function(){e.DEBUG&&console.time("document prepare"),e.DEBUG&&console.time("document render"),e.DEBUG&&console.time("document math done"),e.DEBUG&&console.time("window loaded"),e.DEBUG&&console.time("document math preprocess"),a=n(a),null!=a&&(dom=t(a.selector),e.addSpinner(dom),e.includeFiles(dom),e.handleMath(dom),MathJax.Hub.Queue(["Typeset",MathJax.Hub]),MathJax.Hub.Queue(function(){mlTex.DEBUG&&console.timeEnd("document math preprocess"),mlTex.mathDone=!0}))}),t(window).load(function(){e.DEBUG&&console.timeEnd("window loaded");var t=setInterval(function(){if(e.mathDone){var n=dom.find(".MathJax_Preview").length,i=dom.find(".MathJax").length,o=dom.find(".MathJax_Processing").length;n===i&&0===o&&(r=!0),r&&(e.DEBUG&&console.timeEnd("document math done"),clearInterval(t),setTimeout(function(){e.attrify(dom),e.wrapper(dom),e.indexToc(dom),e.makeToc(dom),e.makeRef(dom),e.makeRefPage(dom,a.biblography),e.fillMath(dom),e.DEBUG&&console.timeEnd("document prepare"),e.texify(a.options,dom),e.fillToc(dom),e.fillRef(dom),e.DEBUG&&console.timeEnd("document render"),e.removeSpinner()},100))}},100)})},e}(mlTex||{},jQuery);